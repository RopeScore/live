<div v-if="loaded.config">
  <p>Viewing
    <b>{{ config.name || '' }}</b>
    (<b>${fed}</b>)</p>
  <p>
    <a @click="toggleCatVisibility()">
      <span v-show="!config.visible">
        <i class="fas fa-eye"></i>
        Make Category Visible</span>
      <span v-show="config.visible">
        <i class="fas fa-eye-slash"></i>
        Hide Category</span>
    </a>
    <a @click="delCat()">
      <i class="far fa-trash-alt"></i>
      Delete Category
    </a>
  </p>
  <div>
    <input type="text" v-model="config.group" placeholder="Group" class="pretty"/>
    <button @click="saveGroup">Save group</button>
    <p>{{ saveStatus }}</p>
  </div>
</div>

<div class="table" v-if="loaded.config && loaded.participants && loaded.scores">
  <table name="overall" class="mt">
    <thead>
      <tr>
        <th :colspan="(anyMembers ? 4 : 3)"></th>
        <th colspan="2" v-for="event in sortedEvents">{{ event.abbr }}</th>
        <th colspan="2">Overall</th>
      </tr>
      <tr>
        <th>{{ (anyMembers ? 'Team ' : '') }}Name</th>
        <th v-show="anyMembers">Team Members</th>
        <th>Club</th>
        <th>id</th>

        <template v-for="event in sortedEvents">
          <th>
            <a @click="publishAll(event.abbr)">Publish All</a>
          </th>
          <th v-if="isSpeed(event.abbr)">
            <a @click="displayAll(event.abbr)">Display all on Projector</a>
          </th>
          <th v-else="v-else">Projector</th>
        </template>

        <th>
          <a @click="publishAll('overall')">Publish All</a>
        </th>
        <th>
          <a @click="displayAll('overall')">Display all on Projector</a>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="(participant, uid) in participants">
        <td>{{ (participant ? participant.name : '') }}</td>
        <td v-show="anyMembers">{{ (participant ? participant.members : '') }}</td>
        <td>{{ (participant ? participant.club : '') }}</td>
        <td>{{ uid }}</td>

        <template v-for="event in sortedEvents">
          <td>
            <a
              v-if="scores[event.abbr][uid] && !scores[event.abbr][uid].dns"
              :class="{green: scores[event.abbr][uid] && scores[event.abbr][uid].display, red: !scores[event.abbr][uid] || !scores[event.abbr][uid].display}"
              @click="togglePub(event.abbr, uid)">{{ (scores[event.abbr][uid] && scores[event.abbr][uid].display ? 'Unpublish' : 'Publish') }}</a>
            <span
              v-show="scores[event.abbr][uid] && scores[event.abbr][uid].dns"
              class="gray">DNS</span>
          </td>
          <td>
            <a
              v-show="onDisplay(event.abbr, uid) && !scores[event.abbr][uid].dns"
              @click="display(event.abbr, uid)"
              :class="{green: scores[event.abbr][uid] && scores[event.abbr][uid].projector}">Remove from Display</a>
            <a
              v-show="!onDisplay(event.abbr, uid) && scores[event.abbr][uid] && !scores[event.abbr][uid].dns"
              @click="display(event.abbr, uid)"
              :class="{red: !scores[event.abbr][uid] || !scores[event.abbr][uid].projector}">Display</a>
            <span
              v-show="scores[event.abbr][uid] && scores[event.abbr][uid].dns"
              class="gray">DNS</span>
          </td>
        </template>

        <td>
          <a
            v-if="scores.overall[uid]"
            :class="{green: scores.overall[uid] && scores.overall[uid].display, red: !scores.overall[uid] || !scores.overall[uid].display}"
            @click="togglePub('overall', uid)">{{ (scores.overall[uid] && scores.overall[uid].display ? 'Unpublish' : 'Publish') }}</a>
        </td>
        <td>
          <a
            v-show="onDisplay('overall', uid)"
            @click="display('overall', uid)"
            :class="{green: scores.overall[uid] && scores.overall[uid].projector}">Remove from Display</a>
          <a
            v-show="!onDisplay('overall', uid) && scores.overall[uid]"
            @click="display('overall', uid)"
            :class="{red: !scores.overall[uid] || !scores.overall[uid].projector}">Display</a>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div v-else="v-else">
  <div class="pc">
    <div id="pro-bar" class="pb" :style="{width: percentage}">
      <div id="pro-lab" class="prl">{{ percentage }}</div>
    </div>
  </div>
</div>